# 图书阅读项目记录

### 图书阅读 我的第一个练手项目，如果有错误的地方请指正


##### *项目功能计划*

1. 用户（一个√是后端完成，两个是全完成）

   登录√√

   注册√√

   修改账户信息√

   退出登录√

   销毁账号√



点赞 =》点击点赞在文章表里面的点赞数加一

收藏 =》点击星星收藏，再次点击取消关注 放到 点赞表里面

关注（follow）=》 点击关注，再次点击取消关注（暂定）



成为作者 =》前端点击成为作者发送请求，条件符合就通过（后台管理员可以判断是否能发表）√



浏览信息

搜索作品

1. 用户搜索√
2. 审核搜索√
3. 作者自己搜索√



评价

2. 作者（用户的升级版）

   发表作品√

   删除作品

   修改作品√

   查看作品点赞数量√

   查看作品收藏数量√

3. 管理员

   浏览全部作品 =》 查看所有作品√

   下架作品 √

   查看新增作品 =》 获取今天新增作品，如果提交过则不出现√

   设置热点（自动设置）

   查看所有作者√

   查看所有用户√

   封号√

   解封√

   分类（暂定）


##### *前端技术*

1. vite （打包工具）
2. vue3
3.  vant4 （移动组件）
4.  vue Router （路由设置）

##### *后端技术*

1. springboot
2.  springMVC + mybatis-plus （效率开发
3. Mysql数据库 +
4. Readis 缓存（暂定，因为readis很贵）
5.  swagger + knife4j（接口文档）





# 前后端初始化

1. 前端初始化√
    1. 初始化
    2. 引入组件
2. 后端初始化√
    1. 准备环境
    2. 初始化后端项目



# 数据库设计（注意加索引）

***用户表（user，内容暂定，之后会修改）***

​	userId（用户id）bigint 唯一性索引

​	nickName（用户名称）varchar

​	userAccount（账户） 唯一性索引

​	userPassword（用户密码）varchar

​	avatarUrl（头像）varchar

​	gender（性别）tinyint

​	phone（电话）varchar

​	email（邮箱）varchar

​	userStatus （状态）tinyint 0-正常 1-封号

​	userRole （用户角色）tinyint 0-普通用户 1-作者 2 -管理员

​	createTime （创建时间）datetime

​	updateTime （修改时间）datetime

​	isDelete（逻辑删除）tinyint 0-正常 1-删除

***文章表（text）（要修改，把作者名字字段删除，防止改名字到导致，文章表大部分修改）***

​	textId (文章Id) bigint

​	textTitle（文章标题）varchar

​	textAuthorName（作者名字）varchar

​	textAuthorId（作者Id） bigint

​	showImgUrl（封面）varchar

​	textAdress（作品地址）varchar

​	textLikeNumber（喜欢数）bigint

​	textFavoriteNumber（收藏数量）bigint

​	textStatus （状态）tinyint 0-正常 1-删除

​	createTime （创建时间）datetime

​	updateTime （修改时间）datetime

​	isDelete（逻辑删除）tinyint 0-正常 1-删除

***收藏夹（favorites）***

​	id (收藏夹id，根据用户编号设计) bigint

​	textId（作品id） bigint

​	userId (收藏人)

​	createTime （创建时间）datetime

​	updateTime （修改时间）datetime

​	isDelete（逻辑删除）tinyint 0-正常 1-删除





##### 需求分析



##### 实现

用户

1. ##### *登录*√

    1. 判断密码和账号是否为空
    2. 判断账号长度是否大于6
    3. 判断密码密码长度和是否大于八
    4. 校验特殊字符
    5. 判断用户是否存在
    6. 脱敏把用户放到session里面

2. ##### *注册√*

    1. 判断密码和账号是否为空
    2. 判断账号长度是否大于6
    3. 判断密码密码长度和是否大于八
    4. 确认密码和判断密码是否相等
    5. 校验特殊字符
    6. 判断账户不能重复
    7. 注册

3. ##### *登出√*

    1. 判断是否登录

4. ##### *销毁账号*√

    1. 是否登录
    2. 是否为管理员，是否是自己不是管理员或者本人不能修改
    3. 判断对方是否为管理员，管理员之间不能互相删除

5. ##### *用户搜索作品* √

    1. 判断是否搜索信息是否为空
    2. 判断页长和页数是否合理
    3. 查找作者从用户名
    4. 查找从文章名字
    5. 返回数据带修改时间
    6. 返回数据，作者id，作品id，作者名字，作品介绍，作品标题，文章图片

6. ##### *查看作者*

    1. 参数判断（作者id）
    2. 获取作者信息（作者id，作者昵称，作者头像）

7. ##### *点赞*（新增点赞表，防止刷赞）

    1. 参数判断

    2. 判断是否登录

    3. 判断是否是同一人（否则保错）

    4. 点赞加一

       ##### *数据库设计*（注意索引）

       [【仿掘金系列】社区点赞功能的实现 - 掘金 (juejin.cn)](https://juejin.cn/post/6844904153529974798)

       id bigint

       textId bigint

       userId bigint

       createTime date

       updateTime date

       isDelete tinyint

       点赞

        1. 参数判断（用户id，textId）
        2. 是否登录
        3. 是否是自己点赞
        4. 判断是否
        5. 判断是否点过赞
        6. 传出点赞id，没有删除



8. ##### *收藏 (收藏表，防止多收藏多次)*

    1. 判断是否登录
    2. 判断是否是自己收藏
    3. 增加到收藏表内容，文章表内容（事物处理），加锁（暂定）
    4. 目前一张表，后期人数多优化（[参考评论——果冻虾仁](https://www.zhihu.com/question/447769164)）
        1. 增（增和删除放一块）
            1. 参数 - 用户id，文章id，
            2. 参数判断
            3. 判断是否是本人
            4. 判断是否是收藏过
            5. 返回增加id（或者是是否成功，根据情况而定）
        2. 查
            1. 参数 - 用户id
            2. 参数判断
            3. 是否是本人
            4. 传出list<textVo> textVo 要包括作者昵称，文章介绍，文章标题，还有图片，作者id，文章id

9. ##### *关注*

    1. 想法一

        1. 加字段，好维护，写起来简单，后期可能性能不好

    2. 想法二

        1. 新增（关注表），多表查询，比较麻烦，后期性能可能好√

    3. 改

        1. 判断是否登录（统一处理）
        2. 判断是否是自己关注

        3. 判断是否已经关注

        4. 是否是本人查看

    4. 删

        1. 看看是否登录
        2. 是否关注（判断数据是否存在）
        3. 是否是本人

    5. 查

        1. 查看关注列表
        2. 是否登录
        3. 是否是本人
        4. 传出 关注表id，朋友id，朋友名字，朋友头像









      ##### *数据库*

      id bigint

      userId bigint

      friendId bigint

      createTime date

      updateTime date

      isDelete tinyint








1. ##### *评论（新增评论表）*

    1. 参考文章[评论系统数据库设计及实现 - Mario_Xue - 博客园 (cnblogs.com)](https://www.cnblogs.com/godlovesme/p/10708358.html#commentform)
    2. 自己实现（单表通过时间判断评论时间，然后判断评论先后顺序，先这样之后优化为带回复的（主要是懒））
    3. 增
        1. 参数判断（用户id，文章id，评论内容）
        2. 判断是否登录
        3. 判断是否是自己发表
        4. 传出id
    4. 删
        1. 参数判断（用户id，文章id，评论编号）
        2. 判断是否登录
        3. 判断是否是自己操作
        4. 传出是否删除成功或者删除id
    5. 改
        1. 参数判断（用户id，评论编号，评论内容）
        2. 判断是否登录
        3. 判断是否是自己操作
        4. 传出是否删除成功或者删除id
    6. 查
        1. 通过文章查询
        2. 参数判断（文章id，作者id）
        3. 传出参数，（作者id，文章id，作者昵称，文章介绍，文章标题，发表时间，评论列表默认查出前十条）

作者

1. ##### *成为作者*

    1. 发表作品之后就成为作者

    2. ##### *发表作品*（比较麻烦）

        1. 参数判断
        2. 登录判断（全局处理）
        3. 设置为作者
        4. 如果已经为作者，就不修改
        5. 文章内容不能为空
        6. 判断是否为作者本人，不是本人不能修改
        7. 校验信息
            1. 文章标题不能为空 长度 >= 2
            2. 作者不能为空
            3. 作者id不能为空
            4. 封面地址不能为空
            5. 文章地址不能为空
        8. 插入文章到文章表

    3. ##### *删除作品*

        1. 参数判断
        2. 判断是否是本人
        3. 把内容删除

    4. ##### *修改作品*

        1. 参数判断

        2. 判断标题和介绍是否为空

        3. 判断是否为作者本人，不是本人不能修改

        4. 判断数据库是否存在

        5. 修改作品

管理员

1. ##### *封号*

    1. 判断权限
    2. 不能封管理员的账号

2. ##### *解封*

    1. 判断权限

3. ##### *管理员搜索作品*

    1. 参数判断
    1. 是否登录
    1. 是否是管理员
    1. 判断是查看审核过的还是未审核的
    1. 返回数据带创建时间和最近修改时间

4. ##### *下架作品*

    1. 判断参数
    2. 判断是否为管理员
    3. 把作品状态设置为下架

5. ##### *发表作品（发表的作品为公告）（暂定）*









# 前端开发

##### 页面设计

1. 主页
2. 图书页
3. 我的页面
4. 搜索页面
5. 文章内容页面
6. 用户内容页面
7. 发表页面





